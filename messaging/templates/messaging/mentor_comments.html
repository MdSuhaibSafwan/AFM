{% extends 'base/base.html' %}
{% load static %}
{% block title %} Messages {% endblock %}
{% load administration_extras %}
{% load messaging_extras %}
{% load crispy_forms_tags %}
{% block css %}
<style>
    .decline-btn {
        background-color: none;
        color: #141e42;
        border: 1px solid #141e42
    }

    .decline-btn:hover {
        background-color: #141e42;
        color: white !important;
    }

    @media screen and (-webkit-min-device-pixel-ratio: 0) {
        select,
        textarea,
        input {
            font-size: 16px !important;
        }
    }

    @media (max-width: 767px) {
        .az-content .container, .az-content.pd-y-20 {
            padding: 0 !important;
        }
    }

    /* .services-btn {
        } */
    .btn:hover {
        color: #212529;
    }

    .services-btn:hover {
        background-color: #141e42;
        color: white !important;
    }

    .service-back {
        background-color: #141e42;
        color: white !important;
    }

    .service-info {
        color: #141e42;
        line-height: 1.3;
        font-weight: 500;
        font-size: 17px;
        position: relative;
        display: inline-block;
        z-index: 2;
    }

    .service-label {
        color: #8e97b3;
        font-size: 14px;
        text-transform: uppercase;
        font-weight: 500;
        letter-spacing: 1px;
    }

    .date-div {
        margin-right: 75px;
    }

    .datepicker table tr td {
        color: #141e42;
        border-radius: 20px;
        padding: 8px 12px;
    }

    .datepicker table tr td.disabled {
        color: #141e42;
        border-radius: 23px;
    }

    .datepicker table tr td.disabled:hover {
        color: #141e42;
        cursor: not-allowed;
    }

    .time-row {
        height: 106%;
        width: 44%;
        overflow: scroll;
        display: grid;
        grid-gap: 10px;
        grid-template-columns: repeat(2, 1fr);
    }

    .time-row-bg {
        padding-top: 4px !important;
        padding-bottom: 0px !important;
    }

    input[name="timeslots_for_date"]:checked + label {
        background-color: #141e42;
        color: white !important;
    }

    .sw .toolbar {
        padding: 0.8rem;
        text-align: right;
    }
    .whatsapp-icon{
        display:none;
    }
</style>
{% endblock %}
{% block content %}
<nav aria-label="breadcrumb">

    <ol class="breadcrumb breadcrumb-style1">
        <li class="breadcrumb-item"><a href="{% url 'administration:dashboard' %}">Dashboard</a></li>
        <li class="breadcrumb-item"><a href="{% url 'messaging:comment_list_user_twfl' %}">Back</a></li>
    </ol>
    <!--            <p class="all-terms">All communication is to be carried out in accordance with our Terms & Conditions.</p>-->
</nav>
<div class="az-content az-content-app pd-b-0 height">
    <div class="container dis-flex">
        <div class="card flex-dir">
            <div class="az-content-body az-content-body-chat d-block">
                <div class="az-chat-header">
                    <div class="az-img-user">
                        <img id='my_profile_pic' src="{% static 'images\default_profile.png' %}" alt="">
                    </div>
                    <div class="az-chat-msg-name">
                        <h6 class="text-capitalize">{{applicant_profile.first_name}}</h6>
                        <small>{{applicant_profile.user_type|getuser}}
<!--                            {% if applicant_profile.user_type == 3 %}(Age: -->
<!--                            {% endif %}-->
                            {% if applicant_profile.user_type == 5 %}
                            {% if applicant_profile.parent.country %}
                            ( From: {{applicant_profile.parent.country.name}}
                            <img src="{{applicant_profile.parent.country.flag}}"
                                 alt="{{applicant_profile.parent.country.name}}"> )
                            {% endif %}
                            {% endif %}
                        </small>
                    </div>
                    {% if applicant_profile.user_type == 3 %}
                    <!-- <div class="az-chat-msg-name mr-3 chat-none">
                        <h6>Area of study:</h6>
                        <small>
                            {{applicant_personal_info.area_of_study|getsubject}}
                        </small>
                    </div> -->
<!--                    <div class="az-chat-msg-name ml-5 mr-3 chat-none">-->
<!--                        <h6>Currently in:</h6>-->
<!--                        <small>{{applicant_personal_info.admin.currently_living_in.name}}-->
<!--                            <img src="{{applicant_personal_info.admin.currently_living_in.flag}}"-->
<!--                                 alt="{{applicant_personal_info.admin.currently_living_in.name}}">-->
<!--                        </small>-->
<!--                    </div>-->
<!--                    <div class="az-chat-msg-name mr-3 chat-none">-->
<!--                        <h6>Destination(s):</h6>-->
<!--                        <small>{{ applicant_personal_info.study_destination|print_study_destination }}</small>-->
<!--                    </div>-->
<!--                    <div class="az-chat-msg-name mr-3 chat-none">-->
<!--                        <h6>Intake year:</h6>-->
<!--                        <small>{{applicant_personal_info.intake_year}}</small>-->
<!--                    </div>-->


                    <!-- <div class="az-chat-msg-name mr-3 chat-none">
                        <h6>Spoken Language(s):</h6>
                        <small>{{applicant_personal_info.admin.spoken_languages.all|print_languages}}</small>
                    </div> -->
                    {% endif %}
                    <nav class="nav">
                        {% if applicant_profile.user_type == 12 or request.user.user_type == 12 %}
                        {% else %}
                        <div class="az-chat-msg-name chat-none">
                            <a href="#" data-toggle="modal" data-target="#servicesmodal"> <b> Create Booking </b> </a>
                        </div>
                        {% endif %}

                        {% if applicant_profile.user_type == 3 %}
                        <a href="#" class="" data-toggle="modal"
                           data-target="#user-more-detail">
                            <i data-feather="info" class="more-vertical ml-2" data-toggle="collapse">
                            </i>
                        </a>
                        {% endif %}
                        <a href="#" class="ml-3 d-md-block d-none" data-toggle="modal"
                           data-target="#report-user" title="Report User"><i data-feather="alert-octagon"></i></a>
                        <i data-feather="more-vertical" class="more-vertical ml-3 d-block d-md-none" data-toggle="collapse"
                           href="#collapseExample1">
                        </i>
                        <div class="collapse" id="collapseExample1">
                            <div class="card card-body">
                                <ul>
<!--                                    <li class="pd-b-4">-->
<!--                                        <a href="#" class="add-booking-link"-->
<!--                                           data-booking-link-applygroup="https://booking.theapplygroup.com/?mentor-id={{user.slug}}"-->
<!--                                           data-booking-link="{% if mentor_late_point_link %}{{ mentor_late_point_link }}{% endif %}">-->
<!--                                            <i data-feather="eye"></i>-->
<!--                                            {% if mentor_late_point_link %}-->
<!--                                            Discovery Call Now (within 24 hours)-->
<!--                                            {% else %}-->
<!--                                            Meeting link will be available soon-->
<!--                                            {% endif %}-->
<!--                                            <br>-->

<!--                                        </a>-->
<!--                                    </li>-->
                                    <li class="pd-b-4 d-block d-md-none">
                                        <a href="#" data-toggle="modal" data-target="#report-user">
                                            <i data-feather="alert-octagon"></i>Report</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </nav>
                </div>
                <!-- Modal -->
                <div class="modal fade" id="servicesmodal" tabindex="-1" role="dialog"
                     aria-labelledby="servicesmodalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl"
                         style="height: 90vh;">
                        <div class="modal-content">
                            <div class="modal-body" style="padding-bottom: 0;">

                                <div id="smartwizard">
                                    <ul class="nav d-none">
                                        <li><a class="nav-link" href="#step-1">Service</a></li>
                                        <li><a class="nav-link" href="#step-2">Booking Info</a></li>
                                    </ul>
                                    <div class="tab-content">
                                        <div id="step-1" class="tab-pane" role="tabpanel">
                                            <div class="row mt-2" href="Step-1">

                                                <p class="my-3 py-3 mb-0 text-center"
                                                   style="background-color: #141e42; color: white;"><b>Your Student ID
                                                    : 3PDA52N8</b>
                                                </p>
                                                <hr class="my-3">

                                                {% for service in services %}
                                                <div class="col-lg-6 col-sm-12">
                                                    <a class="btn my-3 w-100 services-btn sw-btn-next sw-btn"
                                                       id="{{ service.id }}"
                                                       style="margin-right:15px;color: #141e42;border:2px solid #141e42;font-size: 15px;"
                                                       onclick="serviceSelected('{{ service.id }}', '{{ service.title }}')">
                                                        {% if service.price == 0 or not paypal_acc %}
                                                        <b> Free </b> {{ service.title }}
                                                        {% elif service.price != 0 and paypal_acc %}
                                                        {{ service.title }} <br>
                                                        {%endif%}
                                                    </a>
                                                </div>
                                                {% endfor %}
                                            </div>
                                        </div>

                                        <div id="step-2" class="tab-pane" role="tabpanel">
                                            <div class="row">

                                                <div class="col-lg-4 col-sm-12 col-md-12 "
                                                     style="border-right: 1px solid #141e42;">
                                                    <!-- Check Responsiveness Here!-->
                                                    <p class="my-3 py-3 mb-0 text-center"
                                                       style="background-color: #141e42; color:white;">
                                                        <b> Your Student ID: 3PDA52N8 </b>
                                                    </p>
                                                    <div class="row pt-1 justify-content-center">
                                                        <form method="POST" id="timeslotform">
                                                            {% csrf_token %}


<!--                                                            <div class="col-12 mb-5">-->
<!--                                                                {% if paypal_acc %}-->

<!--                                                                <div class="input-group mb-3">-->
<!--                                                                    <button class="btn btn-outline-secondary dropdown-toggle"-->
<!--                                                                            type="button" data-bs-toggle="dropdown"-->
<!--                                                                            aria-expanded="false">Currency-->
<!--                                                                    </button>-->
<!--                                                                    <ul name="currency"-->
<!--                                                                        class="dropdown-menu id_currency"-->
<!--                                                                        id="id_currency">-->
<!--                                                                        <li><a class="dropdown-item" href="#">USD</a>-->
<!--                                                                        </li>-->
<!--                                                                        <li><a class="dropdown-item" href="#">GBP</a>-->
<!--                                                                        </li>-->
<!--                                                                        <li><a class="dropdown-item" href="#">EUR</a>-->
<!--                                                                        </li>-->
<!--                                                                    </ul>-->
<!--                                                                    <input type="number" min="0" class="form-control"-->
<!--                                                                           name="cost" id="session_cost"-->
<!--                                                                           placeholder="COST OF SESSION"-->
<!--                                                                           aria-label="Text input with dropdown button">-->
<!--                                                                </div>-->
<!--                                                                {% else %}-->
<!--                                                                <p class="text-center"><strong>To offer Premium-->
<!--                                                                    Services, please <a style="color: #141e42;"-->
<!--                                                                                        href="{% url 'payments:paypal-onboarding' %}">Onboard-->
<!--                                                                        your PayPal account</a></strong></p>-->
<!--                                                                {% endif %}-->
<!--                                                            </div>-->

                                                        </form>
                                                    </div>

                                                    <div class="row mx-3 mt-2">
                                                        <p class="service-info text-center" style="padding:0px;">Your
                                                            Selected
                                                            Service is:</p>

                                                        <a class="btn service-back "
                                                           style="margin-right:15px;font-size: 15px;border-radius: 0.25rem;padding: 1rem 1rem"
                                                           id="selected_service"><b></b></a>
                                                        <a class="btn mt-2 service-label sw-btn-prev sw-btn"
                                                           style="margin-right:15px;font-size: 15px;border-radius: 0.25rem;padding: 1rem 1rem">Change
                                                            Service</a>

                                                    </div>
                                                </div>

                                                <div class="col-lg-8 col-sm-12 main-form-div">

                                                    <div class="row d-flex m-0 p-0">
                                                        <div class="col-lg-6 col-sm-12">
                                                            <label style="font-size: 15px;color: #141e42;"
                                                                    class="text-left form-label">
                                                                Please Select your Ideal <b>Date</b> for this
                                                                Appointment
                                                            </label>
                                                            <div style="font-size: 15px;color: #141e42;"
                                                                 class="pt-3 d-flex justify-content-center date-div"
                                                                 id="sandbox-container" name="date">
                                                            </div>
                                                        </div>


                                                        <!-- <label style="font-size: 15px;color: #141e42;"
                                                                class="times-label text-left my-2 form-label">Please
                                                            Select your Ideal <b>Time</b> (24 Hours Format) for this
                                                            Appointment <br> <span style="color: red;">(UTC Time)</span>
                                                        </label> -->

                                                        <div class="col-lg-6 col-sm-12 justify-content-center">
                                                            <label class="mt-3 d-flex justify-content-center times-header">
                                                                <span class="" style="font-size: 20px; color:#141e42;">Set Agreed Time</span>
                                                            </label>
                                                            <p class="text-center" style="color: red;">
                                                                ({{applicant_profile.timezone}} Time)</p>

                                                                <div style="height: 20vh;"
                                                                     class="d-flex justify-content-center align-items-center">
                                                                    <input type="time" name="timeForAppointment"
                                                                           id="ATime"
                                                                           required
                                                                           class="timeInput text-center"
                                                                           style="border-style: none;outline: none; font-size: 35px!important;margin-right:15px;">
                                                                </div>

                                                            <div class="input-group mb-3">
                                                                    <button class="btn btn-outline-secondary"
                                                                            style="padding-right: 2rem;" type="button">
                                                                        Duration
                                                                    </button>
                                                                    <input class="form-control" type="number" min="10" required
                                                                           maxlength="3" name="duration" max="120"
                                                                           placeholder="10-120 minutes"
                                                                           id="id_duration">
                                                                </div>

                                                            <!-- <div class="col-lg-12 col-sm-12 d-flex justify-content-center"
                                                                    style="max-height: 15rem;" id="setTimeslot">
                                                                <div class="time-row" id="timeslots_for_date"></div>
                                                            </div> -->
                                                        </div>

                                                        <div class="row mt-2 justify-content-center discussions hidden">
                                                            <div class="col-12">
                                                        <textarea style="border-radius: 11px;border: 1px solid;"
                                                                  type="text" name="detail" required rows="2"
                                                                  id="id_detail" class="form-control"
                                                                  placeholder="Please add further details of what this booking will include & any other specifics you may have discussed and agreed."></textarea>
                                                            </div>
                                                        </div>

                                                        <div class="mt-3 d-flex justify-content-center"
                                                             id="modal_footer">
                                                            <button type="button"
                                                                    style="float:right; background-color: #141e42;color: white;"
                                                                    class="btn"
                                                                    onclick="submit_form()">Submit To Student
                                                            </button>
                                                        </div>

                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>

                            <div class="model-footer" style="border-top: 1px solid #141e42;">
                                <div class="row">
                                    <div class="col-lg-2 d-lg-block d-none">
                                        <a class="btn btn-rounded decline-btn mt-3 ml-3" style="float:left;"
                                           data-dismiss="modal"
                                           href="#">Decline</a>
                                    </div>

                                    <div class="col-lg-8 col-sm-12">
                                        <p class="mt-4 terms-info text-center">
                                            Appointment bookings are in accordance with the agreed Terms & Policies.
                                        </p>
                                    </div>

                                    <div class="col-6 d-lg-none d-md-block">
                                        <a class="btn btn-rounded decline-btn mt-3 ml-3" style="float:left;"
                                           data-dismiss="modal"
                                           href="#">Decline</a>
                                    </div>

                                    <div class="col-6 col-lg-2 ">
                                        <img src="{% static 'img/logo/tag-water.png' %}" class="mb-2 mr-3"
                                             style="float: right;" width="60px" alt="TAG Logo">
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>
                </div>
                <!-- az-chat-header -->
                <div id="azChatBody" class="az-chat-body az-chat-body-inner">
                    <div class="content-inner">
                        {% for comment in comments %}
                        {{ comment.id|get_message_receive_date }}
                        <div
                                class="media {% if comment.sender == request.user %}flex-row-reverse{% else %}reverse{% endif %}
                         {% if not comment.read %} unread-msg{% endif %}"
                                {% if not comment.read %}data-id="{{ comment.id }}" {% endif %}>
                            <div class="media-body">
                                <div class="az-msg-wrapper">
                                    <!--                                    {{ comment.comment }}-->
                                    {% if comment.appointment %}
                                    <div class="row" style="width: 34rem">
                                        <div class="col-lg-8 col-md-8 col-sm-8 "
                                             style="border-right: 1px solid #141e42;">
                                            <div>
                                                <h6 class="service-label">Session Date</h6>
                                                <p class="service-info" id="datePara" style="color: white">
                                                    {{comment.appointment.date}}</p>
                                            </div>

                                            <div>
                                                <h6 class="service-label">Session Time</h6>
                                                <div class="service-info">
                                                    <p style="color: white">{{ comment.appointment.from_time }} - {{ comment.appointment.to_time }}
                                                        <span style="color: red;">({{comment.appointment.booker.timezone}} Time)</span>
                                                    </p>
                                                </div>
                                            </div>

                                            <div>
                                                <h6 class="service-label">Cost Of Session</h6>
                                                <p class="service-info" style="color: white">
                                                    {% if comment.appointment.currency == 'USD' %}
                                                    ${{ comment.appointment.cost|floatformat:0 }}
                                                    {% elif comment.appointment.currency == 'GBP' %}
                                                    £{{ comment.appointment.cost|floatformat:0 }}
                                                    {% elif comment.appointment.currency == 'EUR' %}
                                                    €{{ comment.appointment.cost|floatformat:0 }}
                                                    {% elif comment.appointment.cost == 0 %}
                                                    FREE!
                                                    <!-- 0  <span style="color: red;">(FREE)</span> -->
                                                    {% endif %}

                                                </p>
                                            </div>
                                        </div>
                                        <div class="col-lg-4 col-md-4 col-sm-4 "
                                             style="border-right: 1px solid #141e42;">
                                            <div>
                                                <h6 class="service-label">Service</h6>
                                                <p class="service-info" style="color: white">{{ comment.appointment.services.title }}</p>
                                            </div>

                                            <div>
                                                <h6 class="service-label">Service Duration</h6>
                                                <p class="service-info" style="color: white">
                                                    {{comment.appointment.duration_minutes}} minutes</p>
                                            </div>
                                            {% if comment.appointment.status == 'Cancelled' %}
                                            <div class="row">
                                                <a class="btn btn-danger w-50 ml-3 text-white"
                                                href="#">Cancelled </a>
                                            </div>
                                            {% elif comment.appointment.status != 'Cancelled' %}
                                            <div class="row">
                                                <a class="btn btn-info w-50 ml-3 text-white"
                                                href="{% url 'booking:request-cancellation' comment.appointment.id %}">Cancel </a>
                                            </div>
                                            {% endif %}
                                        </div>
                                    </div>

                                    {% else %}
                                    {{ comment.comment|safe }}
                                    {% endif %}
                                    <!--                                    {{ comment.comment|urlize|url_target_blank|linebreaksbr }}-->
                                    <!--                                    {{ comment.comment|urlize|url_target_blank|linebreaksbr|safeseq }}-->
                                    {% if comment.sender == request.user %}
                                    {% if comment.read %}
                                    <i data-feather="check" class="fs-blue fs-dark"></i>
                                    <i data-feather="check" class="fs-blue fs-dark right-0"></i>
                                    {% else %}
                                    <i data-feather="check" class="fs-dark"></i>
                                    <i data-feather="check" class="fs-dark right-0"></i>
                                    {% endif %}
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                    <!-- content-inner -->
                </div>
                <!-- az-chat-body -->
                <div class="az-chat-footer chat-footer pb-lg-4">
                    <input name="msg" type="text" class="form-control type-msg"
                           placeholder="Click Return or Go on your keypad to send">
                    <a href="#" class="az-msg-send d-none" id="msg-send-button"
                       data-receiver="{{applicant_profile.slug}}">
                        <i data-feather="send"></i></a>
                </div>
                <!-- az-chat-footer -->
            </div>
            <!-- az-content-body -->
        </div>
    </div>
</div>

<!-- MODEL Start -->
{% if applicant_profile.user_type == 3 %}
<div class="chat-btn-model">
    <div class="modal fade" id="user-more-detail" tabindex="-1" role="dialog"
         aria-labelledby="exampleModalCenterTitle"
         aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <div>
                        <h5 class="modal-title text-capitalize" id="reportUserModal">
                            {{applicant_basic_info.first_name}}</h5>
                        <p class="mb-0">{{applicant_profile.user_type|getuser}}</p>
                    </div>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="mentor-profile1">
                            <div class="row">
                                <div class="col-xl-12 col-md-12 col-sm-12">
                                    <div class="">
                                        <div class="pd-b-15 pd-t-15">
                                            <div>
                                                <span class="tx-medium">About me:</span>
                                                <span>{{applicant_basic_info.about_me|getifnone}}</span>
                                            </div>
                                            <div>
                                                <span class="tx-medium">Currently in:</span>
                                                <span>
                                                        {{applicant_basic_info.currently_living_in.name}}
                                                        <img src="{{applicant_basic_info.currently_living_in.flag}}"
                                                             alt="{{applicant_basic_info.currently_living_in.name}}">
                                                    </span>
                                            </div>
                                            <div>
                                                <span class="tx-medium">Are you studying an <strong>online</strong> IFG
                                                                Course/Programme?:</span>
                                                <span class="country-flags">
                                                {{student_info.are_you_studying_an_online_course|getyesnostatus}}
                                                </span>
                                            </div>
                                            <div>
                                                <span class="tx-medium">Currently Studying (IFG programmes):</span>
                                                <span class="country-flags">
                                                {{student_info.currently_studying_course|getifnone}}
                                                </span>
                                            </div>
                                            <div>
                                                <span class="tx-medium">Native Language(s):</span>
                                                <span>
                                                    {{applicant_basic_info.native_languages.all|print_languages}}
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                    </div>
                </div>
            <div class="modal-footer">
                <a class="btn btn-rounded btn-indigo" data-dismiss="modal"
                   href="#">Close</a>
            </div>
            </div>

        </div>
    </div>
</div>
{% endif %}
<div class="modal fade" id="report-user" tabindex="-1"
     role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    Report User</h5>
                <button type="button" class="close" data-dismiss="modal"
                        aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form method="POST" action="{% url 'messaging:block_user' applicant_profile.slug %}"
                      id="block-user-url">
                    <div>
                        {% csrf_token %}
                        {% crispy report_user_form %}
                        <div class="alert alert-danger" role="alert">
                            By submitting this form your messaging history with this User will be deleted and
                            you
                            will
                            no longer be able to interact with each other.
                        </div>
                        <div class="modal-btn mg-t-5">
                            <button type="button" class="btn btn-rounded btn-indigo reject"
                                    data-dismiss="modal">
                                Close
                            </button>
                            <button type="submit" class="btn btn-rounded btn-indigo">
                                Confirm
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>


<!-- MODEL End -->
{% endblock %}
{% block js %}
<script src="{% static 'messaging/js/messaging.js' %}"></script>

<script src="https://cdn.jsdelivr.net/npm/smartwizard@6/dist/js/jquery.smartWizard.min.js"
        type="text/javascript"></script>

<script>

    window.onload = () => {
        document.querySelector('.sw-toolbar-elm').style.display = 'none';

    }

    var selected_service_id = 0

    function serviceSelected(service_id, service_name) {
        document.getElementById('selected_service').innerHTML = "<b>" + service_name + "</b>";
        selected_service_id = service_id;
    }

    $(function () {
        // SmartWizard initialize
        $('#smartwizard').smartWizard({
            theme: 'dots',
            enableURLhash: false,
            transition: {
                animation: 'slide', // Effect on navigation, none/fade/slide-horizontal/slide-vertical/slide-swing
                speed: '400', // Transion animation speed
                easing: '' // Transition animation easing. Not supported without a jQuery easing plugin
            },
            toolbarSettings: {
                toolbarPosition: 'top', // none, top, bottom, both
                toolbarButtonPosition: 'right', // left, right, center
                showNextButton: false, // show/hide a Next button
                showPreviousButton: false, // show/hide a Previous button
                toolbarExtraButtons: [] // Extra buttons to show on toolbar, array of jQuery input/buttons elements
            },

        });


        // function EnableFooter() {
        //     document.getElementById("modal_footer").hidden = false
        // }

        // function DisableFooter() {
        //     document.getElementById("modal_footer").hidden = true
        // }

        // var elements = document.getElementsByClassName("sw-btn-prev");
        // for (var i = 0; i < elements.length; i++) {
        //     elements[i].addEventListener('click', DisableFooter, false);
        // }

        // var elements = document.getElementsByClassName("sw-btn-next");
        // for (var i = 0; i < elements.length; i++) {
        //     elements[i].addEventListener('click', EnableFooter, false);
        // }

    });
    function restrictToNumber(inputId) {
      const inputElement = document.getElementById(inputId);

      inputElement.addEventListener('input', function () {
        const inputValue = inputElement.value;
        const filteredValue = inputValue.replace(/[^0-9]/g, '');
        inputElement.value = filteredValue;
      });
    }

    restrictToNumber('id_duration')
</script>

<script src="{% static 'assets/plugin/datapicker/js/bootstrap-datepicker.min.js' %}"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
<script src="{% static 'assets/js/style.js' %}"></script>
<script src="https://cdn.jsdelivr.net/npm/clipboard-js@0.3.6/clipboard.min.js"
        integrity="sha256-gItQ2FJM3Fqui1yy9GX6bPKVb7FmiKUBaTM3QzwHw2w=" crossorigin="anonymous"></script>

<script>

    $(function () {
        $("#sandbox-container").datepicker({
            todayHighlight: true
        }).datepicker('update', new Date());


        // $('.datepicker-inline').click(function() {
        //     console.log('scroll')
        //     let formColumn = document.querySelector(".main-form-div");
        //     $('.main-form-div').scrollTo(0,formColumn.scrollHeight);
        // });

    });

    $(".dropdown-menu").find("li a").click(function () {
        $('.selectedLi').removeClass('selectedLi');
        $(this).addClass('selectedLi');


    });

    function submit_form() {
        console.log('selected_service_id', selected_service_id);

        var duration = document.getElementById('id_duration').value;
        var date = $("#sandbox-container").data('datepicker').getFormattedDate('mm-dd-yyyy');
        var time = document.getElementById('ATime').value;
        var detail = document.getElementById('id_detail').value;

        if (duration === "" || selected_service_id === undefined || selected_service_id === "" || date === "" || time === "" || detail === ""){
            // alert('Duration is required please fill it in and then continue!');
            toastr.options = {
              "closeButton": true,
              "debug": false,
              "newestOnTop": false,
              "progressBar": false,
              "positionClass": "toast-bottom-right",
              "preventDuplicates": false,
              "showDuration": "300",
              "hideDuration": "1000",
              "timeOut": "5000",
              "extendedTimeOut": "1000",
              "showEasing": "swing",
              "hideEasing": "linear",
              "showMethod": "fadeIn",
              "hideMethod": "fadeOut"
            }
            toastr.error('PLease fill in all the fields');
            return;
        };

        // var currency = $('.id_currency li a.selectedLi').text();
        var student = {{ applicant_personal_info.id }};
        $.ajax({
            url: '/booking/booking/',
            type: 'POST',
            headers: {'X-CSRFToken': $('[name="csrfmiddlewaretoken"]').val()},
            data: {
                'selected_service': selected_service_id,
                'duration': duration,
                'date': date,
                'time': time,
                // 'cost': new_cost,
                // 'currency': currency,
                'student': student,
                'detail': detail,
            },
            // cache: false,
            // processData: false,
            dataType: 'json',
            success: function (response) {
                console.log(response);

                // const clipboardItemInput = new ClipboardItem({'text/html' : response['link']});
                // navigator.clipboard.write([clipboardItemInput]);
                $("input[name='msg']").val(response['link']);
                $("input[name='msg']").focus();
                $("#msg-send-button").click();
                // const blob = new Blob([response['link']], {type: "text/html"});
                // const richTextInput = new ClipboardItem({"text/html": blob});
                // navigator.clipboard.write([richTextInput]);
                // console.log(richTextInput);
                //
                // // navigator.clipboard.writeText(response['link']);
                // $('.toast').toast('show');
                toastr.options = {
                  "closeButton": true,
                  "debug": false,
                  "newestOnTop": false,
                  "progressBar": false,
                  "positionClass": "toast-bottom-right",
                  "preventDuplicates": false,
                  "showDuration": "300",
                  "hideDuration": "1000",
                  "timeOut": "5000",
                  "extendedTimeOut": "1000",
                  "showEasing": "swing",
                  "hideEasing": "linear",
                  "showMethod": "fadeIn",
                  "hideMethod": "fadeOut"
                }
                $('#servicesmodal').modal('hide');
                toastr.success('Appointment created successfully');


            },
            error: function (request, status, error) {
                alert('error; ' + error);
            }
            // try {
            //     const content = document.getElementsByClassName('js-output')[0].innerHTML;
            //     const blobInput = new Blob([content], {type: 'text/html'});
            //     const clipboardItemInput = new ClipboardItem({'text/html' : blobInput});
            //     navigator.clipboard.write([clipboardItemInput]);
            //     } catch(e) {
            //     // Handle error with user feedback - "Copy failed!" kind of thing
            //     console.log(e);
            //     }
        });


    }

    // $(document).ready(function () {
    //     $("#myBtn").click(function () {
    //         $('.toast').toast('show');
    //     });
    // });

</script>
{% endblock %}